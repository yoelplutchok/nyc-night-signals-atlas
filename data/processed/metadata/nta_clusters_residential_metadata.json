{
  "output_file": "/Users/yoelplutchok/Desktop/Sleep_ESI_NYC/data/processed/typology/nta_clusters_residential.parquet",
  "run_id": "20251221_173347_6d1961f8",
  "timestamp": "2025-12-21T17:33:48.527766+00:00",
  "inputs": {
    "nta_features_residential": {
      "path": "/Users/yoelplutchok/Desktop/Sleep_ESI_NYC/data/processed/atlas/311_nta_features_residential.parquet",
      "hash": "410e6a1506581aaca22fa2cd2dc9af86fe78f49f9eb0b3d3bd0323fc29e013cc"
    },
    "nta_geo": {
      "path": "/Users/yoelplutchok/Desktop/Sleep_ESI_NYC/data/processed/geo/nta.parquet",
      "hash": "63b25fcefb995bd079be74dce64a85b3276b916033023816ff0bd6122e2673bb"
    }
  },
  "config_digest": "1ea0a2ec40076591312a864424b7f9afbf78125c676e2b2d559a26a8d0d6bdba",
  "config": {
    "time_windows": {
      "primary": {
        "year_start": 2021,
        "year_end": 2023,
        "label": "2021-2023"
      },
      "sensitivity": {
        "year_start": 2022,
        "year_end": 2023,
        "label": "2022-2023 (pandemic distortion check)"
      },
      "exploratory_2019": {
        "year_start": 2019,
        "year_end": 2019,
        "label": "2019 (pre-pandemic baseline, complaints only)"
      }
    },
    "nighttime": {
      "primary": {
        "start_hour": 22,
        "end_hour": 7,
        "label": "22:00-07:00"
      },
      "sensitivity": {
        "start_hour": 23,
        "end_hour": 6,
        "label": "23:00-06:00"
      },
      "timezone": "America/New_York"
    },
    "warm_season": {
      "primary": {
        "months": [
          6,
          7,
          8
        ],
        "label": "Jun-Aug"
      },
      "sensitivity": {
        "months": [
          5,
          6,
          7,
          8,
          9
        ],
        "label": "May-Sep"
      }
    },
    "hot_night_thresholds": {
      "primary_c": 20.0,
      "sensitivity_c": 24.0,
      "percentile": 90
    },
    "spatial_join": {
      "max_distance_ft": 500,
      "projected_crs": "EPSG:2263",
      "geographic_crs": "EPSG:4326"
    },
    "bounds_checks": {
      "epsg_4326": {
        "lon_min": -75.0,
        "lon_max": -73.0,
        "lat_min": 40.0,
        "lat_max": 41.5
      },
      "epsg_2263": {
        "x_min": 900000,
        "x_max": 1100000,
        "y_min": 110000,
        "y_max": 280000
      }
    },
    "noise_311": {
      "complaint_types": [
        "Noise - Residential",
        "Noise - Street/Sidewalk",
        "Noise - Commercial",
        "Noise - Vehicle",
        "Noise - Park",
        "Noise",
        "Noise - Helicopter",
        "Noise - House of Worship"
      ],
      "subtypes": {
        "music": [
          "Loud Music/Party",
          "Loud Music"
        ],
        "construction": [
          "Construction",
          "Construction Before/After Hours"
        ],
        "traffic": [
          "Car/Truck Horn",
          "Car/Truck Music",
          "Engine Idling"
        ]
      }
    },
    "night_bins": {
      "bins": [
        {
          "name": "evening",
          "start": 22,
          "end": 24
        },
        {
          "name": "early_am",
          "start": 0,
          "end": 2
        },
        {
          "name": "core_night",
          "start": 2,
          "end": 4
        },
        {
          "name": "predawn",
          "start": 4,
          "end": 7
        }
      ],
      "late_night_hours": [
        1,
        2,
        3
      ]
    },
    "weekend": {
      "weekend_nights": [
        4,
        5
      ],
      "weekday_nights": [
        0,
        1,
        2,
        3,
        6
      ]
    },
    "raster": {
      "min_coverage": 0.5,
      "max_nodata_fraction": 0.3
    },
    "crosswalk": {
      "weight_tolerance": 0.01
    },
    "random_seeds": {
      "bootstrap": 42,
      "general": 2024,
      "clustering": 12345
    },
    "typology": {
      "k_range": [
        5,
        6,
        7,
        8,
        9
      ],
      "features": [
        "rate_per_1k_pop",
        "rate_per_km2",
        "share_noise___residential",
        "share_noise___street/sidewalk",
        "share_noise___commercial",
        "share_noise___vehicle",
        "share_noise___park",
        "share_noise",
        "share_noise___helicopter",
        "share_noise___house_of_worship",
        "share_evening",
        "share_early_am",
        "share_core_night",
        "share_predawn",
        "late_night_share",
        "weekend_uplift",
        "warm_season_ratio"
      ],
      "min_silhouette": 0.1,
      "min_cluster_size": 2,
      "cluster_labels": {
        "0": "Street-Dominated Activity",
        "1": "Weekend-Heavy Residential",
        "2": "Helicopter Corridor",
        "3": "Airport-Adjacent (Outlier)",
        "4": "Low-Intensity Baseline",
        "5": "Residential-Dominated Outlier",
        "6": "Evening Street Activity",
        "7": "Nightlife & Entertainment",
        "8": "Park-Influenced Outlier"
      },
      "outlier_clusters": [
        3,
        5,
        8
      ]
    },
    "nta_typology": {
      "k_range": [
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        15
      ],
      "min_cluster_count": 200,
      "features": [
        "rate_per_1k_pop",
        "rate_per_km2",
        "share_noise___residential",
        "share_noise___street/sidewalk",
        "share_noise___commercial",
        "share_noise___vehicle",
        "share_noise___park",
        "share_noise",
        "share_noise___helicopter",
        "share_noise___house_of_worship",
        "share_evening",
        "share_early_am",
        "share_core_night",
        "share_predawn",
        "late_night_share",
        "weekend_uplift",
        "warm_season_ratio"
      ],
      "min_silhouette": 0.1,
      "min_cluster_size": 2,
      "singleton_control": {
        "max_singletons": 2,
        "max_singleton_fraction": 0.1
      }
    },
    "hotspots": {
      "cell_size_ft": 820,
      "hotspot_threshold": 10,
      "top_n_cells": 10,
      "top_n_citywide": 100
    },
    "hotspot_investigation": {
      "top_n_cells": 20,
      "latlon_decimals": 5,
      "flags": {
        "repeat_location_share_threshold": 0.9,
        "suspected_artifact_share_threshold": 0.95,
        "suspected_artifact_single_day_threshold": 200
      }
    },
    "hotspot_sensitivity": {
      "grid_sizes_ft": [
        410,
        820,
        1640
      ],
      "thresholds": [
        10,
        25,
        50
      ],
      "top_n_cells": 100,
      "primary_grid_size_ft": 820,
      "primary_threshold_analysis": 10,
      "primary_threshold_map": 50
    }
  },
  "git": {
    "commit": null,
    "dirty": null
  },
  "versions": {
    "python": "3.11.14",
    "geopandas": "1.1.1",
    "pandas": "2.3.3",
    "numpy": "2.3.5",
    "rasterio": "1.4.4",
    "pyproj": "3.7.2",
    "shapely": "2.1.2"
  },
  "extra": {
    "selected_k": 9,
    "silhouette_score": 0.1956022161644418,
    "features_used": [
      "rate_per_1k_pop",
      "rate_per_km2",
      "share_noise___residential",
      "share_noise___street/sidewalk",
      "share_noise___commercial",
      "share_noise___vehicle",
      "share_noise___park",
      "share_noise",
      "share_noise___helicopter",
      "share_noise___house_of_worship",
      "share_evening",
      "share_early_am",
      "share_core_night",
      "share_predawn",
      "late_night_share",
      "weekend_uplift",
      "warm_season_ratio"
    ],
    "random_seed": 12345,
    "reproducibility_verified": true,
    "min_cluster_count": 200,
    "n_eligible_ntas": 195,
    "n_ineligible_ntas": 2,
    "k_scores": [
      {
        "k": 8,
        "silhouette_score": 0.16870340675948242,
        "calinski_harabasz_score": 40.3431039539532,
        "inertia": 1320.627861910374,
        "min_cluster_size": 1,
        "max_cluster_size": 53,
        "cluster_size_std": 19.441820259430443,
        "n_singletons": 2,
        "singleton_fraction": 0.25
      },
      {
        "k": 9,
        "silhouette_score": 0.1956022161644418,
        "calinski_harabasz_score": 39.14380262484607,
        "inertia": 1235.2789340861264,
        "min_cluster_size": 1,
        "max_cluster_size": 55,
        "cluster_size_std": 19.476481543988722,
        "n_singletons": 2,
        "singleton_fraction": 0.2222222222222222
      },
      {
        "k": 10,
        "silhouette_score": 0.1656990244982458,
        "calinski_harabasz_score": 38.6142245785964,
        "inertia": 1151.6295398119332,
        "min_cluster_size": 1,
        "max_cluster_size": 43,
        "cluster_size_std": 15.20690632574555,
        "n_singletons": 3,
        "singleton_fraction": 0.3
      },
      {
        "k": 11,
        "silhouette_score": 0.1533796652578638,
        "calinski_harabasz_score": 37.597906723710835,
        "inertia": 1089.2550019940809,
        "min_cluster_size": 1,
        "max_cluster_size": 37,
        "cluster_size_std": 12.38100384453325,
        "n_singletons": 2,
        "singleton_fraction": 0.18181818181818182
      },
      {
        "k": 12,
        "silhouette_score": 0.1645486090052291,
        "calinski_harabasz_score": 37.38432153601411,
        "inertia": 1020.8968153322297,
        "min_cluster_size": 1,
        "max_cluster_size": 37,
        "cluster_size_std": 11.889245840955038,
        "n_singletons": 2,
        "singleton_fraction": 0.16666666666666666
      },
      {
        "k": 13,
        "silhouette_score": 0.16867289287967843,
        "calinski_harabasz_score": 36.0277600167452,
        "inertia": 982.0893260689846,
        "min_cluster_size": 1,
        "max_cluster_size": 42,
        "cluster_size_std": 11.562538981223272,
        "n_singletons": 3,
        "singleton_fraction": 0.23076923076923078
      },
      {
        "k": 14,
        "silhouette_score": 0.17060931090137585,
        "calinski_harabasz_score": 35.0688622223393,
        "inertia": 942.0937567505603,
        "min_cluster_size": 1,
        "max_cluster_size": 38,
        "cluster_size_std": 11.087085703094168,
        "n_singletons": 2,
        "singleton_fraction": 0.14285714285714285
      },
      {
        "k": 15,
        "silhouette_score": 0.15041720743653883,
        "calinski_harabasz_score": 33.482398075706264,
        "inertia": 919.7637204302802,
        "min_cluster_size": 1,
        "max_cluster_size": 35,
        "cluster_size_std": 9.273618495495704,
        "n_singletons": 3,
        "singleton_fraction": 0.2
      }
    ],
    "cluster_sizes": {
      "-1": 2,
      "0": 55,
      "1": 27,
      "2": 1,
      "3": 1,
      "4": 25,
      "5": 53,
      "6": 17,
      "7": 12,
      "8": 4
    },
    "distinguishing_features": {
      "-1": [
        "Low Volume (excluded from clustering)"
      ],
      "0": [
        "weekend_uplift (high)",
        "share_core_night (low)",
        "late_night_share (low)"
      ],
      "1": [
        "share_noise (high)",
        "share_core_night (high)",
        "late_night_share (high)"
      ],
      "2": [
        "rate_per_1k_pop (high)",
        "rate_per_km2 (high)",
        "warm_season_ratio (high)"
      ],
      "3": [
        "share_noise___house_of_worship (high)",
        "share_noise___vehicle (high)",
        "share_predawn (high)"
      ],
      "4": [
        "share_noise___commercial (high)",
        "weekend_uplift (high)",
        "share_core_night (low)"
      ],
      "5": [
        "rate_per_km2 (low)",
        "share_noise___residential (high)",
        "warm_season_ratio (low)"
      ],
      "6": [
        "share_noise___street/sidewalk (high)",
        "share_core_night (low)",
        "share_evening (high)"
      ],
      "7": [
        "share_noise___helicopter (high)",
        "share_noise___residential (low)",
        "share_core_night (high)"
      ],
      "8": [
        "share_noise___park (high)",
        "share_evening (high)",
        "share_core_night (low)"
      ]
    },
    "qa_stats": {
      "row_count": 197,
      "null_cluster_ids": 0,
      "invalid_cluster_ids": [],
      "cluster_sizes": {
        "-1": 2,
        "0": 55,
        "1": 27,
        "2": 1,
        "3": 1,
        "4": 25,
        "5": 53,
        "6": 17,
        "7": 12,
        "8": 4
      },
      "low_volume_count": 2,
      "min_cluster_size": 1,
      "null_nta_names": 0,
      "null_cluster_labels": 0,
      "low_volume_all_outlier": true,
      "passed": true
    }
  }
}